{"title":"浏览器兼容（js）","date":"2019-05-15T16:00:00.000Z","slug":"browserCompatibility-js","comments":true,"tags":["Js"],"categories":["学习"],"updated":"2019-05-18T05:54:44.165Z","content":"<p><strong>1. 事件绑定</strong><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">eventAdd</span>(<span class=\"params\">obj, event</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (obj.addEventListener) &#123;</span><br><span class=\"line\">        obj.addEventListener()</span><br><span class=\"line\">        <span class=\"comment\">//ff, chorme, safari, opera, IE9+</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        obj.attachEvent()</span><br><span class=\"line\">        <span class=\"comment\">//IE7, 8</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>2. event事件对象</strong><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">document</span>.onclick = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">e</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> e = e || <span class=\"built_in\">window</span>.event</span><br><span class=\"line\">    <span class=\"comment\">// e -&gt; ff</span></span><br><span class=\"line\">    <span class=\"comment\">// window.event -&gt; 非ff</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>3. 获取scrollTop</strong><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> scrollTop = <span class=\"built_in\">document</span>.documentElement.scrollTop || <span class=\"built_in\">document</span>.body.scrollTop</span><br><span class=\"line\"><span class=\"comment\">// document.body.scrollTop -&gt; chorme</span></span><br><span class=\"line\"><span class=\"comment\">// document.documentElement.scrollTop -&gt; 非chorme</span></span><br></pre></td></tr></table></figure></p>\n<p><strong>4. 阻止浏览器默认事件</strong><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">prevent</span>(<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (event.preventDefault) &#123;</span><br><span class=\"line\">        event.preventDefault()</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        event.returnValue()</span><br><span class=\"line\">        <span class=\"comment\">// ie</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>5. 阻止冒泡</strong><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">stop</span>(<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (event.stopPropagation) &#123;</span><br><span class=\"line\">        event.stopPropagation()</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        event.cancleBubble = <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"comment\">// ie</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>6. 滚轮</strong><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">mouseWheel</span>(<span class=\"params\">obj, fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> ff = <span class=\"built_in\">window</span>.navigator.userAgent.indexOf(<span class=\"string\">'Firefox'</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ff != <span class=\"number\">-1</span>) &#123;</span><br><span class=\"line\">        obj.addEventListener(<span class=\"string\">'DOMMouseScroll'</span>, wheel, <span class=\"literal\">false</span>)</span><br><span class=\"line\">        <span class=\"comment\">// ff</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        obj.onmousewheel = wheel</span><br><span class=\"line\">        <span class=\"comment\">// 非ff</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>7. 获取classname</strong><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getClass</span>(<span class=\"params\">className</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">document</span>.getElementsByClassName) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">document</span>.getElementsByClassName(className)</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> arr = []</span><br><span class=\"line\">        <span class=\"keyword\">var</span> els = <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'*'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> reg = <span class=\"keyword\">new</span> <span class=\"built_in\">RegExp</span>(<span class=\"string\">`\\\\b<span class=\"subst\">$&#123;className&#125;</span>\\\\b`</span>, <span class=\"string\">'g'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; els.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (reg.test(els[i].className)) &#123;</span><br><span class=\"line\">                arr.push(els[i])</span><br><span class=\"line\">                reg.lastIndex = <span class=\"number\">0</span></span><br><span class=\"line\">                <span class=\"comment\">// 全局匹配时，lastIndex会记录上一次匹配的位置</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> arr</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n","prev":{"title":"弹性布局和网格布局","slug":"layout-flex&grid"},"next":{"title":"js运行机制","slug":"jsOperatingMechanism"},"link":"http://github.com/post/browserCompatibility-js/"}